var GraphCreator=function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=5)}([function(t,e,n){"use strict";n.r(e),n.d(e,"apiConnector",function(){return r});class o{constructor(){this.promise=new Promise((t,e)=>{this.reject=e,this.resolve=t})}}const i=function(t){this.url="http://graph-slowosiec.clarin-pl.eu/wordnetloom/resources/",this.cache=new Map,this.possibleLangs=["pl","en"],this.lang=t||"pl"};i.prototype.setLang=function(t){const e=this;e.possibleLangs.indexOf(t)<0?console.error('Err, Language can only be chosen to be "pl" or "en"'):e.lang!==t&&(e.cache=new Map,e.lang=t)},i.prototype.entryPoints={settings:"settings/",graph:"graphs/synsets/{id}",synsetFromSense:"senses/{id}/synset",synsetFromLemma:"synsets/search?lemma={lemma}",relationTypes:"relation-types/{id}"},i.prototype._getJson=function(t,e){const n=this;if(!e)return n._getJsonPromise(t);n.cache.has(t)?e(n.cache.get(t)):d3.request(n.url+t).header("Content-Type","application/json").header("Accept-Language",n.lang).get((o,i)=>{i=JSON.parse(i.response),n.cache.set(t,i),e(i)})},i.prototype._getJsonPromise=function(t){const e=this;let n=new o;return e.cache.has(t)?n.resolve(e.cache.get(t)):d3.request(e.url+t).header("Content-Type","application/json").header("Accept-Language",e.lang).get((o,i)=>{i=JSON.parse(i.response),e.cache.set(t,i),n.resolve(i)}),n.promise},i.prototype.getRelationTypes=function(t,e){return t=t||"",this._getJson(this.entryPoints.relationTypes.replace("{id}",t),e)},i.prototype.getSettings=function(t){return this._getJson(this.entryPoints.settings,t)},i.prototype.hasInCache=function(t){return this.cache.has(t)},i.prototype.getFromCache=function(t){return this.cache.has(t)?this.cache.get(t):null},i.prototype.getGraph=function(t,e){this._getJson(this.entryPoints.graph.replace("{id}",t),function(t){e(t||null)})},i.prototype.getSynsetFromSenseId=function(t,e){const n=function(t){e(t)};d3.json(this.url+this.entryPoints.synsetFromSense.replace("{id}",t),function(t,e){n(e||null)})},i.prototype.getSensesFromLemma=function(t,e){d3.json(this.url+this.entryPoints.synsetFromLemma.replace("{lemma}",t),function(t,n){e(n||null)})};const r=new i},function(t,e,n){"use strict";n.r(e),n.d(e,"Edge",function(){return i}),n.d(e,"EdgeContainer",function(){return r});var o=n(0);function i(t,e,n,o,i,r){this.connectionPoints=n,this.pathTextSrc=o[0],this.pathTextTarget=o[1],this.color=i||"#000",this.dotted=r||!1,this.source=t,this.target=e,this.id=this.getUniqueIdentifier(),this.initColor(),this.initDotted()}function r(){this.map=new Map,this[Symbol.iterator]=this.values}i.prototype.api=o.apiConnector,i.prototype.settings=o.apiConnector.getSettings(),i.prototype.initColor=function(){const t=this;if(!t.pathTextSrc&&!t.pathTextTarget)return;const e=e=>{const n=e.relations[t.pathTextSrc]||e.relations[t.pathTextTarget];try{t.color=n.color}catch(e){console.log(e),console.log(t)}};t.api.hasInCache(t.api.entryPoints.settings)?e(t.api.getFromCache(t.api.entryPoints.settings)):t.settings.then(t=>{e(t)})},i.prototype.initDotted=function(){const t=this;if(!t.pathTextSrc&&!t.pathTextTarget)return;const e=e=>{const n=e.relations[t.pathTextSrc]||e.relations[t.pathTextTarget];try{t.dotted=n.dotted}catch(e){console.log(e),console.log(t)}};t.api.hasInCache(t.api.entryPoints.settings)?e(t.api.getFromCache(t.api.entryPoints.settings)):t.settings.then(t=>{e(t)})},i.prototype.getUniqueIdentifier=function(){return this.source.id<this.target.id?this.source.id+"|"+this.target.id:this.target.id+"|"+this.source.id},r.prototype.add=function(t){t&&this.map.set(t.id,t)},r.prototype.values=function(){return this.map.values()},r.prototype.deleteNodeEdges=function(t){let e=this;e.map.forEach(n=>{n.source!==t&&n.target!==t||e.map.delete(n.id)})}},function(t,e,n){"use strict";n.r(e),n.d(e,"consts",function(){return p}),n.d(e,"GraphCreator",function(){return h});var o=n(0),i=n(1),r=n(4),a=n(3);const s=".inner-graph-container",d=".possible-senses",l=".graph-loader",c={plWordNet:{appendLanguageInfo:function(t,e){return this.append("rect").attr("x",-37).attr("y",-13).attr("width",13).attr("height",8).attr("stroke","black").attr("stroke-width",.4).attr("fill",t=>{return`url('#flag-${e.lexicons[t.lexicon].icon}')`}),this},appendBasicNode:function(t){return this.append("polyline").classed("inner-node",!0).attr("points","-50,10 -10,15 10,15 50,10 50,-10 10,-15 -10,-15 -50,-10 -50,10").attr("stroke-width","1px").attr("stroke","black").attr("fill",function(t){return t.type.color||"red"}).on("click",function(t){let e=new CustomEvent("nodeClicked",{detail:{node:t}});document.dispatchEvent(e)})},appendTriangles:{top:function(){return this.append("polyline").attr("points","-13 -15, 13 -15, 0 -5, -13 -15").attr("stroke-width","1.5px").attr("fill","blue").attr("stroke","black").classed("expanded",function(t){return t.expandedTop})},right:function(){return this.append("polyline").attr("points","50,10 40 0, 50 -10").attr("stroke-width","1.5px").attr("fill","blue").attr("stroke","black").classed("expanded",function(t){return t.expandedRight})},bottom:function(){return this.append("polyline").attr("points","-13 15, 13 15, 0 5, -13 15").attr("stroke-width","1.5px").attr("fill","blue").attr("stroke","black").classed("expanded",function(t){return t.expandedBottom})},left:function(){return this.append("polyline").attr("points","-50,10 -40 0, -50 -10").attr("stroke-width","1.5px").attr("fill","blue").attr("stroke","black").classed("expanded",function(t){return t.expandedLeft})}},appendClipPath:function(){return this.append("clipPath").attr("id","clip").append("use").attr("xlink:href","#rect")},setNodeTitle:function(t,e){return this.append("text").attr("text-anchor","middle").attr("font-size","10px").text(e.length<18?e:String(e).slice(0,15)+"...").attr("dy","3"),this}},yiddish:{appendLanguageInfo:function(t,e){return this.append("circle").attr("cx",-25).attr("cy",-14).attr("r",7).attr("fill","white").attr("stroke-width",.5).attr("stroke","#7f7f7f"),this.append("text").attr("x",-25).attr("y",-12.5).attr("text-anchor","middle").attr("font-size","5px").attr("fill","#7f7f7f").text(t=>{return e.lexicons[t.lexicon].icon.toUpperCase()}),this},appendBasicNode:function(t){return this.append("rect").attr("id","rect").attr("height","30").attr("width","100").attr("x","-50").attr("y","-15").attr("rx","15").attr("ry","45").classed("inner-node",!0).attr("stroke-width","1px").attr("stroke","#304F99").attr("fill",function(t){return"#A9B5D6"})},appendTriangles:{top:function(){return this.append("circle").attr("fill","#304F99").attr("r","8").attr("cy","-16").attr("clip-path","url(#clip)").classed("expanded",function(t){return t.expandedTop})},right:function(){return this.append("circle").attr("fill","#304F99").attr("r","8").attr("cx","50").attr("clip-path","url(#clip)").classed("expanded",function(t){return t.expandedRight})},bottom:function(){return this.append("circle").attr("fill","#304F99").attr("r","8").attr("cy","16").attr("clip-path","url(#clip)").classed("expanded",function(t){return t.expandedBottom})},left:function(){return this.append("circle").attr("fill","#304F99").attr("r","8").attr("cx","-50").attr("clip-path","url(#clip)").classed("expanded",function(t){return t.expandedLeft})}},appendClipPath:function(){return this.append("clipPath").attr("id","clip").append("use").attr("xlink:href","#rect")},setNodeTitle:function(t,e){return this.append("text").attr("text-anchor","middle").attr("font-size","10px").text(e.length<18?e:String(e).slice(0,15)+"...").attr("dy","3").attr("fill","white"),this}},plwordnet_mobile:{appendLanguageInfo:function(t,e){return this.append("rect").attr("x",-42).attr("y",-15).attr("width",13).attr("height",8).attr("stroke","black").attr("stroke-width",.4).attr("fill",t=>{return`url('#flag-${e.lexicons[t.lexicon].icon}')`}),this},appendBasicNode:function(t){return this.append("rect").attr("id","rect").attr("height","30").attr("width","100").attr("x","-50").attr("y","-15").attr("rx","15").attr("ry","30").classed("inner-node",!0).attr("stroke-width","1px").attr("stroke",function(t){switch(t.partOfSpeechId){case 1:return"#876005";case 2:case 3:return"#346637";case 4:return"#055893"}return"red"}).attr("fill",function(t){switch(t.partOfSpeechId){case 1:return"#FED25C";case 2:case 3:return"#8BDFAE";case 4:return"#678ADA"}return"red"})},appendTriangles:{top:function(){return this.append("circle").attr("fill",function(t){switch(t.partOfSpeechId){case 1:return"#A78025";case 2:case 3:return"#548657";case 4:return"#2578B3"}return"red"}).attr("r","8").attr("cy","-16").attr("stroke-width","30.0").attr("stroke","#FFFFFF01").classed("expanded",function(t){return t.expandedTop})},right:function(){return this.append("circle").attr("fill",function(t){switch(t.partOfSpeechId){case 1:return"#A78025";case 2:case 3:return"#548657";case 4:return"#2578B3"}return"red"}).attr("r","8").attr("cx","50").attr("stroke-width","30.0").attr("stroke","#FFFFFF01").classed("expanded",function(t){return t.expandedRight})},bottom:function(){return this.append("circle").attr("fill",function(t){switch(t.partOfSpeechId){case 1:return"#A78025";case 2:case 3:return"#548657";case 4:return"#2578B3"}return"red"}).attr("r","8").attr("cy","16").attr("stroke-width","30.0").attr("stroke","#FFFFFF01").classed("expanded",function(t){return t.expandedBottom})},left:function(){return this.append("circle").attr("fill",function(t){switch(t.partOfSpeechId){case 1:return"#A78025";case 2:case 3:return"#548657";case 4:return"#2578B3"}return"red"}).attr("r","8").attr("cx","-50").attr("stroke-width","30.0").attr("stroke","#FFFFFF01").classed("expanded",function(t){return t.expandedLeft})}},appendClipPath:function(){return this.append("clipPath").attr("id","clip").append("use").attr("xlink:href","#rect")},setNodeTitle:function(t,e){return this.append("text").attr("text-anchor","middle").attr("font-size","12px").attr("font-family","arial").text(e.length<17?e:String(e).slice(0,14)+"...").attr("dy","3").attr("fill","black"),this}}},p={partOfSpeech:{1:{color:"#FED25C"},2:{color:"#ABFFAE"},3:{color:"#ABFFAE"},4:{color:"#ACFFEA"}},partOfSpeech_mobile:{1:{color:"#FED25C"},2:{color:"#8BDFAE"},3:{color:"#8BDFAE"},4:{color:"#678ADA"}}},h=function(t,e,n,r){const a=this;a.width=n,a.height=r;let c='<div class="graph-loader hidden"><div class="spin"></div></div><div class="inner-graph-container"></div>';e&&(c+='<div id="toolbox"><form id="inspected-word-form"><button type="submit" value="Submit" id="inspected-word-btn">Szukaj</button><input type="text" id="inspected-word" placeholder="Słowo którego szukasz&hellip;"></form><ul class="possible-senses" style="display: none"></ul></div>'),c+='<button id="download-picture"></button>';const h=d3.select("#"+t).html(c);a.container=h,a.setVisualSettings("plWordNet");const u=h.select(s).append("svg").attr("width",n).attr("height",r).attr("id","graph-svg");a.hiddenList=d3.select(s).append("div").style("display","none").attr("pointer-events","none").attr("class","hidden-list tooltip").style("opacity",1),a.filterHiddenListInput=a.hiddenList.append("div").append("form").append("input").attr("id","filter-search-bar").attr("type","text").attr("placeholder","Filter..."),a.filterHiddenListInput.on("keyup",(t,e,n)=>{a.filterHiddenList(n[0].value)}),a.hiddenListContent=a.hiddenList.append("div"),a.sensesList=d3.select(d),a.tooltip=d3.select(s).append("div").attr("id","node-tooltip").style("opacity",0),a.loadingAnimationHandle=d3.select(l),a.idct=0,a.nodes=new Map,a.edges=new i.EdgeContainer,a.transformed={x:0,y:0,k:1},a.state={selectedNode:null,selectedEdge:null,mouseDownNode:null,mouseDownLink:null,justDragged:!1,justScaleTransGraph:!1,lastKeyDown:-1,shiftNodeDrag:!1,selectedText:null,brushSelect:!1},a.api=o.apiConnector,a.setLanguage("pl"),a.settings=a.api.getSettings(),a.settings.then(t=>{p.partOfSpeech=t.partsOfSpeech}),a.relationTypes=a.api.getRelationTypes();const f=u.append("svg:defs");f.append("svg:marker").attr("id","end-arrow").attr("viewBox","0 -5 10 10").attr("refX","8").attr("markerWidth",8).attr("markerHeight",8).attr("orient","auto").append("svg:path").attr("d","M0,-5L10,0L0,5L4,0"),f.append("svg:marker").attr("id","start-arrow").attr("viewBox","0 0 10 10").attr("refX",2).attr("refY",5).attr("markerWidth",8).attr("markerHeight",8).attr("orient","auto").append("svg:path").attr("d","M0,5L10,0L7,5L10,10"),f.append("pattern").attr("id","flag-pl").html('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="10" id="Flag of Poland" viewBox="0 0 16 10"><rect width="16" height="4" fill="#fff"/><rect width="16" height="5" fill="#dc143c" y="4"/></svg>').attr("width",16).attr("height",16),f.append("pattern").attr("id","flag-en").attr("width",16).attr("height",16).html('<svg x="-1.5" viewBox="0 0 60 30" width="16" height="8">\n    <clipPath id="t">\n        <path d="M30,15 h30 v15 z v15 h-30 z h-30 v-15 z v-15 h30 z"/>\n    </clipPath>\n    <path d="M0,0 v30 h60 v-30 z" fill="#00247d"/>\n    <path d="M0,0 L60,30 M60,0 L0,30" stroke="#fff" stroke-width="6"/>\n    <path d="M0,0 L60,30 M60,0 L0,30" clip-path="url(#t)" stroke="#cf142b" stroke-width="4"/>\n    <path d="M30,0 v30 M0,15 h60" stroke="#fff" stroke-width="10"/>\n    <path d="M30,0 v30 M0,15 h60" stroke="#cf142b" stroke-width="6"/>\n</svg>'),a.svg=u,a.svgOuter=u.append("g").classed("outer-zoom",!0).attr("transform","translate(0,0) scale(1)"),a.svgG=a.svgOuter.append("g").classed(a.consts.graphClass,!0).attr("id","wordnet-graph-g-element");const g=a.svgG;a.paths=g.append("g").attr("id","all-paths-id").selectAll("g"),a.pathsText=g.append("g").attr("id","all-paths-text-id").selectAll("g"),a.boats=g.append("g").attr("id","all-boats-id").selectAll("g"),a.drag=d3.drag().subject(function(t){return a.range.x.max=Math.max(t.x,a.range.x.max),a.range.y.max=Math.max(t.y,a.range.y.max),a.range.x.min=Math.min(t.x,a.range.x.min),a.range.y.min=Math.min(t.y,a.range.y.min),{x:t.x,y:t.y}}).on("drag",function(t){a.state.justDragged=!0,a.dragmove.call(a,t)}),d3.select(window).on("keydown",function(){a.svgKeyDown.call(a)}).on("keyup",function(){a.svgKeyUp.call(a)}),u.on("mousedown",function(t){a.svgMouseDown.call(a,t)}),u.on("mouseup",function(t){a.svgMouseUp.call(a,t)});const y=d3.zoom().on("zoom",function(){return!d3.event.sourceEvent.shiftKey&&(a.zoomed.call(a),!0)}).on("start",function(){var t=d3.select("#"+a.consts.activeEditId).node();t&&t.blur(),d3.event.sourceEvent.shiftKey||d3.select("body").style("cursor","move")}).on("end",function(){d3.select("body").style("cursor","auto")});a.zoom=y,u.call(y).on("dblclick.zoom",null),window.onresize=function(){a.updateWindow(u)};a.brush=d3.brush(),a.brush.graph=this,a.brush.on("brush",function(){a.brushed()}),d3.select("#inspected-word-form").on("submit",function(){d3.event.preventDefault(),console.log("on submit");let t=d3.select("#inspected-word");a.loadNewWord(t.node().value)}),d3.select("#download-picture").on("click",function(){a.exportVisualization()}),a.range={x:{min:Number.MAX_SAFE_INTEGER,max:Number.MIN_SAFE_INTEGER},y:{min:Number.MAX_SAFE_INTEGER,max:Number.MIN_SAFE_INTEGER}}};h.prototype.langDict={colors_of_nodes:{pl:"Kolory synsetów:",en:"Synsets colors:"},verb:{pl:"Czasownik",en:"Verb"},noun:{pl:"Rzeczownik",en:"Noun"},adverb:{pl:"Przysłówek",en:"Adverb"},adjective:{pl:"Przymiotnik",en:"Adjective"}},h.prototype._=function(t){return this.langDict[t][this.lang]},h.prototype.setLanguage=function(t){if(["pl","en"].indexOf(t)<0)throw{error:"Only 'pl' and 'en' language codes are possible",function:"GraphCreator.prototype.setLanguage"};this.lang=t,this.api.setLang(t)},h.prototype.setVisualSettings=function(t){const e=this,n=Object.keys(c);if(-1===n.indexOf(t))throw"Settings name '"+t+"' is invalid, please use value from [\""+n.join('" or "')+'"]';e.selectedVisualSetitings=t,n.forEach(t=>{e.container.classed("style-"+t,!1)}),e.container.classed("style-"+t,!0)},h.prototype.withVisualSettings=function(t,e,...n){let o=c[this.selectedVisualSetitings][e];return e instanceof Array&&(o=c[this.selectedVisualSetitings],e.forEach(t=>{o=o[t]})),o.bind(t)(this,...n)},h.prototype.showMiniMap=function(t,e,n,o,i,r){t=t||.25,(e=e||this.container)!==this.container&&(e=d3.select(e)),n&&i&&(i=null),null===n&&null===i&&(n=0),o&&r&&(r=null),null===o&&null===r&&(r=0);let a=d3.select("#graph-svg"),s=t;this.minimap=d3.minimap().host(this).target(a).targetShadowId("#all-boats-id").targetShadowId("#all-paths-id").minimapScale(s).x(0).y(0);let d=e.append("svg").attr("class","svg canvas clarin-graph-visualization").attr("width",this.width*t).attr("height",this.height*t).attr("shape-rendering","auto").style("position","absolute");null!=n&&d.style("top",n),null!=o&&d.style("right",o),null!=i&&d.style("bottom",i),null!=r&&d.style("left",r),d.call(this.minimap),this.minimap.render()},h.prototype.showLegend=function(t,e,n,o,i){const r=this;(t=t||r.container)!==r.container&&(t=d3.select(t)),e&&o&&(o=null),null===e&&null===o&&(e=0),n&&i&&(i=null),null===n&&null===i&&(i=0);let a=t.append("div").attr("class","legend-card clarin-graph-visualization").style("position","absolute").style("width",(r.scale?r.scale*r.width:.25*r.width)+"px");r.settings.then(t=>{const e=r._.bind(r);a.html(`<h4>${e("colors_of_nodes")}</h4>\n        <ul>\n          <li><div class="color-demo" style="background-color: ${p.partOfSpeech_mobile[1]}"></div><span>${e("verb")}</span></li>\n          <li><div class="color-demo" style="background-color: ${p.partOfSpeech_mobile[2]}"></div><span>${e("noun")}</span></li>\n          <li><div class="color-demo" style="background-color: ${p.partOfSpeech_mobile[3]}"></div><span>${e("adverb")}</span></li>\n          <li><div class="color-demo" style="background-color: ${p.partOfSpeech_mobile[4]}"></div><span>${e("adjective")}</span></li>\n         </ul>`),a.append("span").text("x").attr("class","close-btn").on("click",()=>{a.style("display","none")})}),null!=e&&a.style("top",e),null!=n&&a.style("right",n),null!=o&&a.style("bottom",o),null!=i&&a.style("left",i)},h.prototype.getHeight=function(){return this.height},h.prototype.getWidth=function(){return this.width},h.prototype.update=function(t){this.zoom.transform(this.svg,t),this.svg.property("__zoom",t)},h.prototype.updateCanvasZoomExtents=function(){var t=this.svg.property("__zoom").k,e=this.svg.attr("width"),n=this.svg.attr("height"),o=this.width,i=this.height;this.zoom.translateExtent([[-o/t,-i/t],[o/t+e,i/t+n]])},h.prototype.showLoadingAnimation=function(){this.loadingAnimationHandle.classed("hidden",!1)},h.prototype.hideLoadingAnimation=function(){this.loadingAnimationHandle.classed("hidden",!0)},h.prototype.listPossibleSenses=function(t){const e=this;if(e.hideLoadingAnimation(),t){const n=function(t){t&&e.initializeFromSynsetId(t.id)};if(0===t.length)e.sensesList.style("display","block").html("").html("<li>nic nie znaleziono</li>");else if(1===t.length)e.api.getSynsetFromSenseId(t[0].id,n);else{let o="";for(let e=0;e<t.length;e++)o+='<li class="hidden-list-item" data-sense-id="'+t[e].id+'">'+t[e].lemma.word+"</li>\n";e.sensesList.style("display","block").html("").html(o),d3.selectAll(".hidden-list-item").on("click",function(){let t=d3.select(this).attr("data-sense-id");e.api.getSynsetFromSenseId(t,n)})}}},h.prototype.loadNewWord=function(t){this.showLoadingAnimation(),this.api.getSensesFromLemma(t,this.listPossibleSenses.bind(this))},h.prototype.initFromJson=function(t){const e=this;try{const n=e.width/2-25,o=e.height/2-100,i=new r.GraphNode(t,n,o,{},e,!0,!0,!0,!0);i.childrenDownloaded=!0,e.nodes.set(i.id,i),e.updateWithChildrenNodes(i)}catch(t){console.log(t),window.alert("Error parsing json\nerror message: "+t.message)}},h.prototype.edgeNotExisting=function(t,e,n){const o=this;for(let n=0;n<o.edges.length;n++){let i=o.edges[n];if(i.source===t&&i.target===e)return!1;if(i.source===e&&i.target===t)return!1}if(void 0!==n)for(let o=0;o<n.length;o++){let i=n[o];if(i.source===t&&i.target===e)return!1;if(i.source===e&&i.target===t)return!1}return!0},h.prototype.addEdgesBetweenNewNodes=function(t){const e=this;let n=function(t,n){e.edges.add(t.getConnectionWithNode(n)),e.edges.add(n.getConnectionWithNode(t))};var o;(o=t).forEach(t=>{o.forEach(e=>{t!==e&&n(t,e)})}),function(t){e.nodes.forEach(e=>{t.forEach(t=>{e!==t&&n(e,t)})})}(t)},h.prototype.updateWithChildrenNodes=function(t){const e=this;let n=[];function o(o,r,a){o&&t[r].forEach((o,s)=>{o=t[r][s],e.nodes.has(o.id)||(e.nodes.set(o.id,o),n.push(o)),o.isNodeCumulator()&&e.edges.add(new i.Edge(t,o,a,o.parentRel))})}o(t.expandedTop,"childrenTopRef",[0,2]),o(t.expandedRight,"childrenRightRef",[1,3]),o(t.expandedBottom,"childrenBottomRef",[2,0]),o(t.expandedLeft,"childrenLeftRef",[3,1]),e.addEdgesBetweenNewNodes(n),e.updateGraph()},h.prototype.consts={selectedClass:"selected",connectClass:"connect-node",boatGClass:"conceptG",graphClass:"graph",activeEditId:"active-editing",BACKSPACE_KEY:8,DELETE_KEY:46,ENTER_KEY:13,CTRL_KEY:17,nodeRadius:50,nodeDistance:225,nodeHeight:35,nodeWidth:50,maxDefaultNodesVertically:6,maxDefaultNodesHorizontally:6},h.prototype.showBrush=function(){const t=this;t.state.brushSelect=!0,t.brushHandle||(t.brushHandle=t.svg.append("g").attr("class","brush").call(t.brush))},h.prototype.destroyBrush=function(){const t=this;t.brushHandle&&(t.brushHandle.remove(),t.brushHandle=null)},h.prototype.exitBrushMode=function(){const t=this;t.state.brushSelect&&(t.unmarkAllNodes(),t.state.brushSelect=!1)},h.prototype.unmarkAllNodes=function(){this.nodes.forEach(function(t){t.unmarkSelected()}),this.updateGraph()},h.prototype.getPointInvertedTranslation=function(t,e,n){return(t-e*(1-n))/n-e},h.prototype.getPointTransform=function(t,e,n){return(t+e)*n+e*(1-n)},h.prototype.getPointTransformX=function(t){return this.getPointTransform(t,this.transformed.x,this.transformed.k)},h.prototype.getPointTransformY=function(t){return this.getPointTransform(t,this.transformed.y,this.transformed.k)},h.prototype.markNodesSelectedInRange=function(t){let e=t[0][0],n=t[1][0],o=t[0][1],i=t[1][1];const r=this.transformed.x,a=this.transformed.y,s=this.transformed.k;e=this.getPointInvertedTranslation(e,r,s),n=this.getPointInvertedTranslation(n,r,s),o=this.getPointInvertedTranslation(o,a,s),i=this.getPointInvertedTranslation(i,a,s),this.nodes.forEach(function(t){t.x>e&&t.x<n&&t.y>o&&t.y<i?t.markSelected():t.unmarkSelected()}),this.updateGraph()},h.prototype.brushed=function(){const t=this,e=d3.event.selection;null===e?t.unmarkAllNodes():t.markNodesSelectedInRange(e)},h.prototype.dragmove=function(t){const e=this;e.state.shiftNodeDrag?e.dragLine.attr("d","M"+t.x+","+t.y+"L"+d3.mouse(e.svgG.node())[0]+","+d3.mouse(this.svgG.node())[1]):(t.selected||e.exitBrushMode(),e.state.brushSelect?e.nodes.forEach(function(t){t.selected&&(t.x+=d3.event.dx,t.y+=d3.event.dy)}):(t.x+=d3.event.dx,t.y+=d3.event.dy),e.updateGraph())},h.prototype.deleteGraph=function(t){const e=this;let n=!0;t||(n=window.confirm("Press OK to delete this graph")),n&&(e.nodes=new Map,e.edges=new i.EdgeContainer,e.resetZoom())},h.prototype.selectElementContents=function(t){var e=document.createRange();e.selectNodeContents(t);var n=window.getSelection();n.removeAllRanges(),n.addRange(e)},h.prototype.getNodeTitle=function(t,e){this.withVisualSettings(t,"setNodeTitle",e)},h.prototype.spliceLinksForNode=function(t){const e=this;e.edges.filter(function(e){return e.source===t||e.target===t}).map(function(t){e.edges.splice(e.edges.indexOf(t),1)})},h.prototype.svgMouseDown=function(){this.state.graphMouseDown=!0,this.state.brushSelect=!1,this.sensesList.style("display","none"),this.hideHiddenList(),this.unmarkAllNodes()},h.prototype.svgMouseUp=function(){const t=this,e=t.state;if(e.justScaleTransGraph)e.justScaleTransGraph=!1;else if(e.graphMouseDown&&d3.event.shiftKey){const e=d3.mouse(t.svgG.node()),n={id:t.idct++,title:p.defaultTitle,x:e[0],y:e[1]};t.nodes.push(n),t.updateGraph()}else e.shiftNodeDrag&&(e.shiftNodeDrag=!1,t.dragLine.classed("hidden",!0));e.graphMouseDown=!1},h.prototype.svgKeyDown=function(){const t=this,e=t.state,n=t.consts;if(-1!==e.lastKeyDown)return;e.lastKeyDown=d3.event.keyCode;const o=e.selectedNode,i=e.selectedEdge;switch(d3.event.keyCode){case n.BACKSPACE_KEY:break;case n.CTRL_KEY:t.showBrush();break;case n.DELETE_KEY:o?(t.nodes.splice(t.nodes.indexOf(o),1),t.spliceLinksForNode(o),e.selectedNode=null,t.updateGraph()):i&&(t.edges.splice(t.edges.indexOf(i),1),e.selectedEdge=null,t.updateGraph())}},h.prototype.svgKeyUp=function(){this.destroyBrush(),this.state.lastKeyDown=-1},h.prototype.removeNodeEdges=function(t){this.edges.deleteNodeEdges(t)},h.prototype.removeNode=function(t){const e=this;e.removeNodeEdges(t);const n=t.getAllChildrenRef();for(let t=0;t<n.length;t++)e.removeNode(n[t]);t.reset(),e.nodes.delete(t.id)},h.prototype.removeNodeChildren=function(t,e){const n=this;let o;o=void 0!==e?t.getChildrenAtPosition(e):t.getAllChildrenRef();for(let t=0;t<o.length;t++)n.removeNode(o[t]);n.updateGraph()},h.prototype.updateGraph=function(){const t=this,e=t.consts,n=t.state,o=Array.from(t.nodes.values());t.boats=d3.select("#all-boats-id").selectAll("g").data(o,function(t){return t.id+t.label}),t.boats.attr("transform",function(t){return"translate("+t.x+","+t.y+")"}).classed("node-selected",function(t){return t.selected}).on("mouseover",function(e){const n=e.x,o=e.y,i=t.transformed;let r="EN";1==e.lexicon&&(r="PL"),e.label.length>=18&&t.showTooltip(t.getPointTransformX(n)+70*i.k,t.getPointTransformY(o)-15,"("+r+") "+e.label)}).on("mouseout",function(){t.hideTooltip()});const i=t.boats.enter().append("g");i.classed(e.boatGClass,!0).attr("transform",function(e){return t.range.x.max=Math.max(e.x,t.range.x.max),t.range.y.max=Math.max(e.y,t.range.y.max),t.range.x.min=Math.min(e.x,t.range.x.min),t.range.y.min=Math.min(e.y,t.range.y.min),"translate("+e.x+","+e.y+")"}).call(t.drag),i.filter(t=>t.isNodeCumulator()).append("circle").attr("r",25).attr("stroke-width","1px").attr("stroke","black").attr("fill",function(t){return t.type.color||"red"}).classed("inner-node",!0).on("click",function(e){let n=e.getHiddenListHtml();e.expandHiddenNodes(t,n.createdIds,n.hiddenRef,this)});let r=i.filter(t=>!t.isNodeCumulator());t.withVisualSettings(r,"appendBasicNode").on("click",function(t){let e=new CustomEvent("nodeClicked",{detail:{node:t}});document.dispatchEvent(e)}),t.settings.then(t=>{this.withVisualSettings(r,"appendLanguageInfo",t)}),i.each(function(e){t.appendChildrenButtons(d3.select(this),e)}),i.each(function(e){t.getNodeTitle(d3.select(this),e.label)});try{t.boats.enter().merge(d3.select("#all-boats-id").selectAll("text"))}catch(t){console.log(t)}t.boats.exit().remove();let a=Array.from(t.edges.values());const s=d3.select("#all-paths-id").selectAll("path").data(a,function(t){return t.id}).classed(e.selectedClass,function(t){return t===n.selectedEdge}).attr("d",function(t){return"M"+t.source.x+","+t.source.y+"L"+t.target.x+","+t.target.y});s.exit().remove(),s.enter().append("path").merge(s).style("marker-end",t=>t.pathTextSrc?"url(#end-arrow)":"").style("marker-start",t=>t.pathTextTarget?"url(#start-arrow)":"").style("stroke-width","1.25").classed("link",!0).classed("dotted",function(t){return t.dotted}).attr("stroke",function(t){return t.color}).attr("d",function(e){const n=t.getConnectionPoints(e);if(e.target.isNodeCumulator())return"M"+n.source.x+","+n.source.y+"L"+e.target.x+","+e.target.y;return"M"+n.source.x+","+n.source.y+"L"+n.target.x+","+n.target.y}).attr("id",function(t,e){return"path_"+String(t.source.id)+"-"+String(t.target.id)});const d=d3.select("#all-paths-text-id").selectAll("text").data(a,function(t,e){return String(t.source.id)+"-"+String(t.target.id)}),l=d.enter().append("text").classed("relation-text",!0).attr("dy",-5);l.exit().remove(),l.append("textPath").on("mouseover",e=>{let n=t.getRelationTooltipCoordinates(e.source,e.connectionPoints[0]);t.relationTypes.then(o=>{let i=o.find(t=>t.short_name===e.pathTextSrc);t.showTooltip(n.x,n.y,i.description)})}).on("mouseout",function(){t.hideTooltip()}).attr("startOffset","5%").attr("xlink:href",function(t){return"#path_"+String(t.source.id)+"-"+String(t.target.id)}).append("tspan").attr("data-text",function(t){return this.text=t.pathTextSrc||"__hidden__",t.pathTextSrc}).attr("fill",function(t){return"__hidden__"===this.text?"none":"black"}),l.append("textPath").on("mouseover",e=>{let n=t.getRelationTooltipCoordinates(e.target,e.connectionPoints[1]);t.relationTypes.then(o=>{let i=o.find(t=>t.short_name===e.pathTextTarget);t.showTooltip(n.x,n.y,i.description)})}).on("mouseout",function(){t.hideTooltip()}).attr("startOffset","95%").attr("text-anchor","end").attr("xlink:href",function(t){return"#path_"+String(t.source.id)+"-"+String(t.target.id)}).append("tspan").attr("dy",15).attr("data-text",function(t){return this.text=t.pathTextTarget||"",t.pathTextTarget}),d.exit().remove(),t.minimap&&(t.minimap.updateMaxValues(t.range),t.minimap.render()),t.rotatePaths()},h.prototype.rotatePaths=function(){d3.select("#all-paths-text-id").selectAll("text").each((t,e,n)=>{d3.select(n[e]).selectAll("tspan").attr("data-rotate",(t,e,n)=>{let o=Math.atan2(t.source.y-t.target.y,t.source.x-t.target.x)*(180/Math.PI),i=o<=0&&o>=-90||o>=0&&o<=90;return t.rotate=i,i}).attr("rotate",t=>t.rotate?180:0).text(function(t){return t.rotate?this.text.split("").reverse().join(""):this.text})})},h.prototype.showTooltip=function(t,e,n){this.tooltip.transition().duration(100).style("opacity",.9),this.tooltip.html(n)},h.prototype.hideTooltip=function(){this.tooltip.transition().duration(200).style("opacity",0)},h.prototype.getRelationTooltipCoordinates=function(t,e){const n=this;let o={x:n.getPointTransformX(t.x),y:n.getPointTransformY(t.y)};switch(e){case 0:o.x+=30*n.transformed.k,o.y-=70*n.transformed.k;break;case 1:o.x+=70*n.transformed.k,o.y-=15*n.transformed.k;break;case 2:o.x+=30*n.transformed.k;break;case 3:o.x-=30*n.transformed.k,o.y-=15*n.transformed.k}return o},h.prototype.appendChildrenButtons=function(t,e){const n=this;n.withVisualSettings(t,"appendClipPath"),e.childrenTop.length>0&&n.withVisualSettings(t,["appendTriangles","top"]).on("click",function(){e.expandTriangleClick(n,this,0)}),e.childrenRight.length>0&&n.withVisualSettings(t,["appendTriangles","right"]).on("click",function(){e.expandTriangleClick(n,this,1)}),e.childrenBottom.length>0&&n.withVisualSettings(t,["appendTriangles","bottom"]).on("click",function(){e.expandTriangleClick(n,this,2)}),e.childrenLeft.length>0&&n.withVisualSettings(t,["appendTriangles","left"]).on("click",function(){e.expandTriangleClick(n,this,3)})},h.prototype.getConnectionPoints=function(t){const e=this;try{return{source:e.getConnectionPoint(t.connectionPoints[0],t.source.x,t.source.y),target:e.getConnectionPoint(t.connectionPoints[1],t.target.x,t.target.y)}}catch(e){console.log(t)}},h.prototype.getConnectionPoint=function(t,e,n){const o=this,i={x:e,y:n};switch(t){case 0:i.y-=o.consts.nodeHeight/2-1;break;case 1:i.x+=51;break;case 2:i.y+=o.consts.nodeHeight/2-1;break;case 3:i.x-=51}return i},h.prototype.zoomed=function(t){t=t||d3.event.transform,this.state.justScaleTransGraph=!0,d3.select("."+this.consts.graphClass).attr("transform",t),this.transformed=t,this.hideHiddenList(),this.minimap&&this.minimap.update(t)},h.prototype.updateWindow=function(t){const e=document.documentElement,n=document.getElementsByTagName("body")[0],o=window.innerWidth||e.clientWidth||n.clientWidth,i=window.innerHeight||e.clientHeight||n.clientHeight;t.attr("width",o).attr("height",i)},h.prototype.initializeFromSynsetId=function(t){const e=this;e.api.getGraph(t,function(t){!function(t){t.length<1?window.alert("Sorry, could not display requested data."):(e.deleteGraph(!0),e.firstInit?e.updateGraph():e.firstInit=!0,e.initFromJson(t))}(t)})},h.prototype.exportVisualization=function(){const t=this.getSVGString(this.svg.node());this.svgString2Image(t,2*this.width,2*this.height,"png",function(t,e){Object(a.saveAs)(t,"wordnet-graph.png")})},h.prototype.getSVGString=function(t){t.setAttribute("xlink","http://www.w3.org/1999/xlink"),function(t,e){const n=document.createElement("style");n.setAttribute("type","text/css"),n.innerHTML=t;const o=e.hasChildNodes()?e.children[0]:null;e.insertBefore(n,o)}(function(t){let e=[];e.push("#"+t.id);for(let n=0;n<t.classList.length;n++)i("."+t.classList[n],e)||e.push("."+t.classList[n]);const n=t.getElementsByTagName("*");for(let t=0;t<n.length;t++){let o=n[t].id;i("#"+o,e)||e.push("#"+o);const r=n[t].classList;for(let t=0;t<r.length;t++)i("."+r[t],e)||e.push("."+r[t])}let o="";for(let t=0;t<document.styleSheets.length;t++){let n=document.styleSheets[t];try{if(!n.cssRules)continue}catch(t){if("SecurityError"!==t.name)throw t;continue}let r=n.cssRules;for(let t=0;t<r.length;t++)i(r[t].selectorText,e)&&(o+=r[t].cssText)}return o;function i(t,e){return!(-1===e.indexOf(t))}}(t),t);let e=(new XMLSerializer).serializeToString(t);return e=(e=e.replace(/(\w+)?:?xlink=/g,"xmlns:xlink=")).replace(/NS\d+:href/g,"xlink:href")},h.prototype.svgString2Image=function(t,e,n,o,i){o=o||"png";const r="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(t))),a=document.createElement("canvas"),s=a.getContext("2d");a.width=e,a.height=n;const d=new Image;d.onload=function(){s.clearRect(0,0,e,n),s.drawImage(d,0,0,e,n),a.toBlob(function(t){const e=Math.round(t.length/1024)+" KB";i&&i(t,e)})},d.src=r},h.prototype.resetZoom=function(){const t=this;let e=d3.zoomIdentity;t.zoomed(e),t.svg.property("__zoom",e),t.minimap&&t.minimap.resetScale()},h.prototype.resizeSVG=function(t,e){this.svg.attr("width",t).attr("height",e)},h.prototype.hideHiddenList=function(){this.hiddenList.node().scrollTop=0,this.hiddenList.style("display","none"),this.hiddenItems=null,this.filterHiddenListInput.node().value="",this.hiddenList.style("display","none")},h.prototype.initHiddenListItemsRefs=function(){this.hiddenItems=this.hiddenListContent.selectAll(".hidden-item")},h.prototype.filterHiddenList=function(t){this.hiddenItems||this.initHiddenListItemsRefs(),this.hiddenItems.style("display","list-item"),this.hiddenItems.filter((e,n,o)=>{if(o[n].innerHTML.toLowerCase().indexOf(t.toLowerCase())<0)return!0}).style("display","none")},h.prototype.addOnClickToCreatedRelGroups=function(){this.hiddenListContent.selectAll(".rel-group").each((t,e,n)=>{n[e].children[0].onclick=function(){n[e].classList.toggle("minified")}})}},function(t,e,n){"use strict";n.r(e),function(t){n.d(e,"saveAs",function(){return o});
/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */
var o=o||function(t){if("undefined"==typeof navigator||!/MSIE [1-9]\./.test(navigator.userAgent)){var e=t.document,n=function(){return t.URL||t.webkitURL||t},o=e.createElementNS("http://www.w3.org/1999/xhtml","a"),i="download"in o,r=/Version\/[\d\.]+.*Safari/.test(navigator.userAgent),a=t.webkitRequestFileSystem,s=t.requestFileSystem||a||t.mozRequestFileSystem,d=function(e){(t.setImmediate||t.setTimeout)(function(){throw e},0)},l="application/octet-stream",c=0,p=function(t){setTimeout(function(){"string"==typeof t?n().revokeObjectURL(t):t.remove()},4e4)},h=function(t,e,n){for(var o=(e=[].concat(e)).length;o--;){var i=t["on"+e[o]];if("function"==typeof i)try{i.call(t,n||t)}catch(t){d(t)}}},u=function(t){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t},f=function(e,d,f){f||(e=u(e));var g,y,m,x=this,w=e.type,v=!1,b=function(){h(x,"writestart progress write writeend".split(" "))},k=function(){if(y&&r&&"undefined"!=typeof FileReader){var o=new FileReader;return o.onloadend=function(){var t=o.result;y.location.href="data:attachment/file"+t.slice(t.search(/[,;]/)),x.readyState=x.DONE,b()},o.readAsDataURL(e),void(x.readyState=x.INIT)}((v||!g)&&(g=n().createObjectURL(e)),y)?y.location.href=g:void 0===t.open(g,"_blank")&&r&&(t.location.href=g);x.readyState=x.DONE,b(),p(g)},T=function(t){return function(){return x.readyState!==x.DONE?t.apply(this,arguments):void 0}},C={create:!0,exclusive:!1};return x.readyState=x.INIT,d||(d="download"),i?(g=n().createObjectURL(e),void setTimeout(function(){var t,e;o.href=g,o.download=d,t=o,e=new MouseEvent("click"),t.dispatchEvent(e),b(),p(g),x.readyState=x.DONE})):(t.chrome&&w&&w!==l&&(m=e.slice||e.webkitSlice,e=m.call(e,0,e.size,l),v=!0),a&&"download"!==d&&(d+=".download"),(w===l||a)&&(y=t),s?(c+=e.size,void s(t.TEMPORARY,c,T(function(t){t.root.getDirectory("saved",C,T(function(t){var n=function(){t.getFile(d,C,T(function(t){t.createWriter(T(function(n){n.onwriteend=function(e){y.location.href=t.toURL(),x.readyState=x.DONE,h(x,"writeend",e),p(t)},n.onerror=function(){var t=n.error;t.code!==t.ABORT_ERR&&k()},"writestart progress write abort".split(" ").forEach(function(t){n["on"+t]=x["on"+t]}),n.write(e),x.abort=function(){n.abort(),x.readyState=x.DONE},x.readyState=x.WRITING}),k)}),k)};t.getFile(d,{create:!1},T(function(t){t.remove(),n()}),T(function(t){t.code===t.NOT_FOUND_ERR?n():k()}))}),k)}),k)):void k())},g=f.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(t,e,n){return n||(t=u(t)),navigator.msSaveOrOpenBlob(t,e||"download")}:(g.abort=function(){var t=this;t.readyState=t.DONE,h(t,"abort")},g.readyState=g.INIT=0,g.WRITING=1,g.DONE=2,g.error=g.onwritestart=g.onprogress=g.onwrite=g.onabort=g.onerror=g.onwriteend=null,function(t,e,n){return new f(t,e,n)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||(void 0).content);t.exports?t.exports.saveAs=o:"undefined"!=typeof define&&null!==define&&null!==n(8)&&define([],function(){return o})}.call(this,n(7)(t))},function(t,e,n){"use strict";n.r(e),n.d(e,"GraphNode",function(){return s});var o=n(0),i=n(2),r=n(1);let a={calculateEllipseY:function(t,e,n,o,i,r){return r?o+Math.sqrt(e*e-(1-(i-n)*(i-n))/(t*t)):o-Math.sqrt(e*e-(1-(i-n)*(i-n))/(t*t))},calculateEllipseX:function(t,e,n,o,i,r){return r?n-Math.sqrt(e*e-(1-(i-o)*(i-o))/(t*t)):n+Math.sqrt(e*e-(1-(i-o)*(i-o))/(t*t))},distributeNode:function(t,e,n){return-(n*t*2)/2+2*t*(e+1)-t},assignPlace:function(t,e,n,o,r){const s=i.GraphCreator.prototype.consts;switch(r=r>=s.maxDefaultNodesHorizontally?s.maxDefaultNodesHorizontally:r,t){case"top":n.x=e.x+a.distributeNode(s.nodeWidth+2,o,r),n.y=-200+a.calculateEllipseY(8,1,e.x,e.y,n.x,!0);break;case"right":n.y=e.y+a.distributeNode(s.nodeHeight-15,o,r),n.x=200+a.calculateEllipseX(3,1,e.x,e.y,n.y,!0);break;case"bottom":n.x=e.x+a.distributeNode(s.nodeWidth+10,o,r),n.y=e.y+s.nodeDistance,n.y=200+a.calculateEllipseY(8,1,e.x,e.y,n.x,!1);break;case"left":n.x=e.x-s.nodeDistance,n.y=e.y+a.distributeNode(s.nodeHeight-15,o,r),n.x=-200+a.calculateEllipseX(3,1,e.x,e.y,n.y,!1)}}};const s=function(t,e,n,o,i,r,a,s,d){let l=this;l.graph=i,t&&(l.parentId=o.id||null,l.parent=o||null,t=l.prepareJson(t),l.id=t.id,l.label=t.label,l.partOfSpeechId=t.pos,l.lexicon=t.lex,l.assignColorBasedFromPartOfSpeech(),l.x=e||0,l.y=n||0,l.childrenTop=t.top.expanded.concat(t.top.hidden),l.childrenRight=t.right.expanded.concat(t.right.hidden),l.childrenBottom=t.bottom.expanded.concat(t.bottom.hidden),l.childrenLeft=t.left.expanded.concat(t.left.hidden),l.parentRel=t.rel,l.childrenTopRef=[],l.childrenRightRef=[],l.childrenBottomRef=[],l.childrenLeftRef=[],l.cumulativeNodes={},l.addCumulativeChildren(t),l.initChildren(t.top.expanded,t.right.expanded,t.bottom.expanded,t.left.expanded)),l.selected=!1,l.expandedTop=r||!1,l.expandedRight=a||!1,l.expandedLeft=d||!1,l.expandedBottom=s||!1,l.childrenDownloaded=!1};s.prototype.reset=function(){this.expandedTop=!1,this.expandedRight=!1,this.expandedLeft=!1,this.expandedBottom=!1},s.prototype.assignPlace=function(t,e,n){a.assignPlace(t,this.parent,this,e,n)},s.prototype.initChildren=function(t,e,n,o){const i=this;function r(t,e,n){let o,r=t.length+i[e].length;for(let a=0;a<t.length;a++)(o=i.graph.nodes.get(t[a].id))||((o=new s(t[a],0,0,i,i.graph)).assignPlace(n,a,r),i[e].push(o));i.childrenDownloaded=!0}r(t,"childrenTopRef","top"),r(e,"childrenRightRef","right"),r(n,"childrenBottomRef","bottom"),r(o,"childrenLeftRef","left")},s.prototype.prepareJson=function(t){function e(t,e){t[e]||(t[e]={expanded:[],hidden:[]}),t[e].expanded||(t[e].expanded=[]),t[e].hidden||(t[e].hidden=[])}return e(t,"top"),e(t,"right"),e(t,"bottom"),e(t,"left"),t},s.prototype.addCumulativeChildren=function(t){const e=this;function n(n){let o;e.cumulativeNodes[n]=null,t[n].hidden.length>0&&0!==t[n].expanded.length&&((o=new d({id:-t[n].hidden[0].id,type:{color:"green"},rel:[null,null]},e,t[n].hidden,n)).assignPlace(n,e["children"+n.charAt(0).toUpperCase()+n.slice(1)+"Ref"].length+1,e["children"+n.charAt(0).toUpperCase()+n.slice(1)+"Ref"].length-2),e["children"+n.charAt(0).toUpperCase()+n.slice(1)+"Ref"].push(o)),e.cumulativeNodes[n]=o}n("top"),n("right"),n("bottom"),n("left")},s.prototype.addChildrenAtPosIfNotParent=function(t,e){let n=this;n[e]=n[e].concat(t.filter(t=>t.id!==n.parentId))},s.prototype.addToCumulativeNode=function(t,e){const n=this;e=["top","right","bottom","left"][e],t.forEach(t=>{n.cumulativeNodes[e].addHiddenNode(t)})},s.prototype.updateChildrenPosition=function(t){let e=this,n=["Top","Right","Bottom","Left"][t],o=e["children"+n+"Ref"],i=o.slice(5);i.length>0&&e.addToCumulativeNode(i,t),o=o.slice(0,5),e["children"+n+"Ref"]=o,o.forEach((t,e)=>{t.assignPlace(n.toLowerCase(),e,o.length)})},s.prototype.updateChildren=function(t,e){this.childrenDownloaded||(t=this.prepareJson(t),this.addChildrenAtPosIfNotParent(t.top.hidden,"childrenTop"),this.addChildrenAtPosIfNotParent(t.right.hidden,"childrenRight"),this.addChildrenAtPosIfNotParent(t.bottom.hidden,"childrenBottom"),this.addChildrenAtPosIfNotParent(t.left.hidden,"childrenLeft"),this.childrenTopRef=[],this.childrenRightRef=[],this.childrenBottomRef=[],this.childrenLeftRef=[],this.addCumulativeChildren(t),this.initChildren(t.top.expanded,t.right.expanded,t.bottom.expanded,t.left.expanded),this.expandedTop=0===e,this.expandedRight=1===e,this.expandedBottom=2===e,this.expandedLeft=3===e,this.childrenDownloaded=!0)},s.prototype.markSelected=function(){this.selected=!0},s.prototype.unmarkSelected=function(){this.selected=!1},s.prototype.assignColorBasedFromPartOfSpeech=function(){let t;t=i.consts.partOfSpeech[this.partOfSpeechId]?i.consts.partOfSpeech[this.partOfSpeechId].color:"#888888",this.type={color:t}},s.prototype.nodeType="ordinary",s.prototype.getType=function(){return"ordinary"},s.prototype.api=o.apiConnector,s.prototype.consts={DIRECTIONS:{TOP:0,RIGHT:1,BOTTOM:2,LEFT:3}},s.prototype.getChildrenWithCallback=function(t){const e=this;e.childrenDownloaded?t(e.apiData):e.api.getGraph(e.id,function(n){e.apiData=n,t(n)})},s.prototype.expandTopClick=function(t,e){this.expandedTop=!0,this.findNewPlace(t),this.getChildrenWithCallback(e)},s.prototype.expandRightClick=function(t,e){this.expandedRight=!0,this.findNewPlace(t),this.getChildrenWithCallback(e)},s.prototype.expandBottomClick=function(t,e){this.expandedBottom=!0,this.findNewPlace(t),this.getChildrenWithCallback(e)},s.prototype.expandLeftClick=function(t,e){this.expandedLeft=!0,this.findNewPlace(t),this.getChildrenWithCallback(e)},s.prototype.moveChildren=function(t){const e=this.getAllChildrenRef();for(let n=0;n<e.length;n++){let o=[e[n].x-t[0],e[n].y-t[1]];e[n].assignNewPosition(o),e[n].moveChildren(t)}},s.prototype.getChildrenAtPosition=function(t){const e=this;switch(t){case 0:return e.childrenTopRef;case 1:return e.childrenRightRef;case 2:return e.childrenBottomRef;case 3:return e.childrenLeftRef}},s.prototype.connectionPointTypes={0:[0,2],1:[1,3],2:[2,0],3:[3,1],top:[0,2],right:[1,3],bottom:[2,0],left:[3,1]},s.prototype.getConnectionWithNode=function(t){const e=this;for(let[n,o]of["childrenTop","childrenRight","childrenBottom","childrenLeft"].entries()){let i=e[o].filter(e=>e.id===t.id)[0];if(i)return new r.Edge(e,t,e.connectionPointTypes[n],i.rel)}return null},s.prototype.getAllChildren=function(){return this.childrenTop.concat(this.childrenRight,this.childrenBottom,this.childrenLeft)},s.prototype.getAllChildrenRef=function(){return this.childrenTopRef.concat(this.childrenRightRef,this.childrenBottomRef,this.childrenLeftRef)},s.prototype.assignNewPosition=function(t){this.x=t[0],this.y=t[1]},s.prototype.findNewPlace=function(t){const e=this;let n=[e.x,e.y],o=20,i=10;for(;!e.checkIfSpaceInRegion(n,t)&&i>0;)n=e.calculatePossibleNewPosition(o),o+=20,i--;return e.moveChildren([e.x-n[0],e.y-n[1]]),e.assignNewPosition(n),n},s.prototype.checkIfSpaceInRegion=function(t,e){const n=this,o=t[0],i=t[1],r=n.getAllChildrenRef();for(let[t,a]of e){if(r.indexOf(a)>-1)continue;const t=a.x,e=a.y;if(n.expandedTop&&n.checkIfPointInRange(t,e,o-500,o+500,i-500,i))return!1;if(n.expandedRight&&n.checkIfPointInRange(t,e,o,o+1e3,i-250,i+250))return!1;if(n.expandedBottom&&n.checkIfPointInRange(t,e,o-500,o+500,i,i+500))return!1;if(n.expandedLeft&&n.checkIfPointInRange(t,e,o-1e3,o,i-250,i+250))return!1}return!0},s.prototype.checkIfPointInRange=function(t,e,n,o,i,r){return t>n&&t<o&&(e>i&&e<r)},s.prototype.calculatePossibleNewPosition=function(t){const e=this,n=e.parent,o=n.x-e.x,i=n.y-e.y;let r=e.x,a=e.y;if(!e.parent.x||!e.parent.y)return[r,a];const s=i/o;return 0===o||Math.abs(o)<50?a=i>0?e.y-t:e.y+t:0===i&&o<0?r=e.x+t:i<0?s<0?(r=e.x-t,a=e.y-t*s):(r=e.x+t,a=e.y+t*s):s<0?(r=e.x+t,a=e.y+t*s):(r=e.x-t,a=e.y-t*s),[r,a]},s.prototype.isNodeCumulator=function(){return!1},s.prototype.expandTriangleClick=function(t,e,n){const o=this,i=["expandedTop","expandedRight","expandedBottom","expandedLeft"][n],r=["expandTopClick","expandRightClick","expandBottomClick","expandLeftClick"][n];o[i]?(o[i]=!1,t.removeNodeChildren(o,n),d3.select(e).classed("expanded",!1),o.graph.hideLoadingAnimation()):(o.graph.showLoadingAnimation(),o[r](t.nodes,function(i){o.updateChildren(i,n),o.updateChildrenPosition(n),t.updateWithChildrenNodes(o),d3.select(e).classed("expanded",!0),o.graph.hideLoadingAnimation()}))};const d=function(t,e,n,o){s.call(this,t,100,100,e,e.graph),this.hiddenNodes=n||[],this.grouppedHiddenNodes=this.groupHiddenNodes(),this.positionRelativeToParent=o,this.label=this.hiddenNodes.length,this.hiddenButVisible=0,this.childrenTop=[],this.childrenRight=[],this.childrenBottom=[],this.childrenLeft=[]};d.prototype=new s,d.prototype.constructor=d,d.prototype.nodeType="cumulator",d.prototype.groupHiddenNodes=function(){const t=this;let e=[];t.hiddenNodes=t.hiddenNodes.reduce((t,e)=>t.findIndex(t=>t.id===e.id)<0?[...t,e]:t,[]);for(let n of t.hiddenNodes){let t=n.rel.filter(t=>!!t).join(" - ");e[t]||(e[t]=[]),e[t].push(n)}return e},d.prototype.getType=function(){return"cumulator"},d.prototype.getHiddenNodes=function(){return this.hiddenNodes},d.prototype.updateCount=function(){this.label=this.hiddenNodes.length-this.hiddenButVisible},d.prototype.decrementTitle=function(t){const e=this;e.label-=1,d3.select(t.parentNode).select("text").text(e.label+"..."),0===e.label&&this.graph.removeNode(e)},d.prototype.expandHiddenNode=function(t,e,n){const o=this;o.graph.hideHiddenList();let i=t[1];o.api.getGraph(i.id,function(e){e.rel=i.rel;let a=new s(e,o.x+100+Math.floor(20*Math.random()-10),o.y+100+ +Math.floor(20*Math.random()-10),o.parent,o.graph);a.childrenDownloaded=!0,o.parent["children"+o.positionRelativeToParent.charAt(0).toUpperCase()+o.positionRelativeToParent.slice(1)+"Ref"].push(a),o.graph.nodes.set(a.id,a);let d=o.connectionPointTypes[o.positionRelativeToParent];o.hiddenNodes.splice(o.hiddenNodes.indexOf(i),1),o.grouppedHiddenNodes[t[0]].splice(o.grouppedHiddenNodes[t[0]].indexOf(i),1),o.decrementTitle(n),o.graph.edges.add(new r.Edge(o.parent,a,d,a.parentRel)),o.graph.addEdgesBetweenNewNodes([a]),o.graph.updateGraph()})},d.prototype.addOnclickToCreatedNodes=function(t,e,n,o){const i=this;for(let t=0;t<e.length;t++)!function(t){let r=e[t];d3.select(r).on("click",function(){i.expandHiddenNode(n[t],i,o)})}(t)},d.prototype.expandHiddenNodes=function(t,e,n,o){this.expandHiddenNode(n[e.length-1],this,o)},d.prototype.isNodeCumulator=function(){return!0},d.prototype.getHiddenListHtml=function(){const t=this;let e={html:"",createdIds:[],hiddenRef:[]};e.html="",t.hiddenButVisible=0;for(let n in t.grouppedHiddenNodes){let o=t.grouppedHiddenNodes[n],i="";i+=`\n    <div class="rel-group">\n    <h5 class="rel-group-name"><i>${n}:</i> <span class="not-expanded">▲</span><span class="expanded">▼</span></h5>\n    <ul class='hidden-nodes-list' style='max-height:${44*o.length}px;'>`;let r=!1;o.forEach((o,a)=>{t.graph.nodes.has(o.id)?t.hiddenButVisible++:(i+="\n<li class='hidden-item' id='hidden-"+o.id+"'>"+o.label+"</li>",r=!0,e.createdIds.push("#hidden-"+o.id),e.hiddenRef.push([n,o]))}),i+="</div></ul>",r&&(e.html+=i)}return t.updateCount(),e},d.prototype.addHiddenNode=function(t){this.hiddenNodes.push({id:t.id,label:t.label,rel:t.parentRel,pos:t.partOfSpeechId}),this.label+=1}},function(t,e,n){n(6),n(3),n(0),n(1),n(4),n(9),t.exports=n(2)},function(t,e){
/*! @source http://purl.eligrey.com/github/canvas-toBlob.js/blob/master/canvas-toBlob.js */
!function(t){"use strict";var e,n=t.Uint8Array,o=t.HTMLCanvasElement,i=o&&o.prototype,r=/\s*;\s*base64\s*(?:;|$)/i,a="toDataURL";n&&(e=new n([62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,0,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51])),!o||i.toBlob&&i.toBlobHD||(i.toBlob||(i.toBlob=function(t,o){if(o||(o="image/png"),this.mozGetAsFile)t(this.mozGetAsFile("canvas",o));else if(this.msToBlob&&/^\s*image\/png\s*(?:$|;)/i.test(o))t(this.msToBlob());else{var i,s=Array.prototype.slice.call(arguments,1),d=this[a].apply(this,s),l=d.indexOf(","),c=d.substring(l+1),p=r.test(d.substring(0,l));Blob.fake?((i=new Blob).encoding=p?"base64":"URI",i.data=c,i.size=c.length):n&&(i=p?new Blob([function(t){for(var o,i,r=t.length,a=new n(r/4*3|0),s=0,d=0,l=[0,0],c=0,p=0;r--;)i=t.charCodeAt(s++),255!==(o=e[i-43])&&void 0!==o&&(l[1]=l[0],l[0]=i,p=p<<6|o,4==++c&&(a[d++]=p>>>16,61!==l[1]&&(a[d++]=p>>>8),61!==l[0]&&(a[d++]=p),c=0));return a}(c)],{type:o}):new Blob([decodeURIComponent(c)],{type:o})),t(i)}}),!i.toBlobHD&&i.toDataURLHD?i.toBlobHD=function(){a="toDataURLHD";var t=this.toBlob();return a="toDataURL",t}:i.toBlobHD=i.toBlob)}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content||this)},function(t,e){t.exports=function(t){if(!t.webpackPolyfill){var e=Object.create(t);e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),Object.defineProperty(e,"exports",{enumerable:!0}),e.webpackPolyfill=1}return e}},function(t,e){(function(e){t.exports=e}).call(this,{})},function(t,e){d3.minimap=function(){"use strict";var t=.15,e=.15,n=null,o=null,i=100,r=100,a=100,s=100,d=0,l=0,c=[];function p(h){h;var u=d3.zoom().scaleExtent([.5,5]),f=function(){var t=g.property("__zoom").k,e=parseInt(o.attr("width")),i=parseInt(o.attr("height")),r=n.getWidth(),a=n.getHeight();u.translateExtent([[-r/t,-a/t],[r/t+e,a/t+i]])};u.on("zoom",function(){if(y.attr("transform",d3.event.transform),d3.event.sourceEvent instanceof MouseEvent||d3.event.sourceEvent instanceof WheelEvent){var t=d3.event.transform,e=d3.zoomIdentity.scale(1/t.k).translate(-t.x,-t.y);n.update(e)}f()});var g=h.append("g").attr("class","minimap clarin-graph-visualization");g.call(u),p.node=g.node();var y=g.append("g").attr("class","frame");y.append("rect").attr("class","background").attr("width",i).attr("height",r),c.forEach(t=>{g.append("use").attr("xlink:href",t)}),p.update=function(t){var e=d3.zoomIdentity.scale(1/t.k).translate(-t.x,-t.y);u.transform(y,e),g.property("__zoom",e),f()};let m={x:null,y:null,xRatio:null,yRatio:null,widthRatio:null,heightRatio:null};p.resetScale=function(){m={x:null,y:null,xRatio:null,yRatio:null,widthRatio:null,heightRatio:null},t=e,d=0,l=0,i=a,r=s},p.render=function(){g.attr("transform","translate("+d+","+l+")scale("+t+")"),y.select(".background").attr("width",i).attr("height",r),y.node().parentNode.appendChild(y.node())},p.updateMaxValues=function(n){let o=n.x.max-n.x.min,a=n.y.max-n.y.min;if(!m.x||!m.y)return m.x=o,m.y=a,m.xRatio=o*t,void(m.yRatio=a*t);let s=Math.min(m.xRatio/o,m.yRatio/a);s<t&&(d=(i*e-i*s)/2,l=(r*e-r*s)/2,t=s)},f()}return p.targetShadowId=function(t){return c.push(t),this},p.width=function(t){return arguments.length?(i=parseInt(t,10),this):i},p.height=function(t){return arguments.length?(r=parseInt(t,10),this):r},p.x=function(t){return arguments.length?(d=parseInt(t,10),this):d},p.y=function(t){return arguments.length?(l=parseInt(t,10),this):l},p.host=function(t){return arguments.length?(n=t,this):n},p.minimapScale=function(n){return arguments.length?(e=t=n,this):t},p.target=function(t){return arguments.length?(o=t,a=i=parseInt(o.attr("width"),10),s=r=parseInt(o.attr("height"),10),this):o},p}}]);